
<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta http-equiv="X-UA-Compatible" content="ie=edge">
    <!-- <link href="reset.css" rel="stylesheet">
    <link href="style.css" rel="stylesheet"> -->
    <link rel="stylesheet" href="https://fonts.googleapis.com/css2?family=Material+Symbols+Outlined:opsz,wght,FILL,GRAD@20..48,100..700,0..1,-50..200" />
    <title>QB-Multicharacter</title>

    <script src="https://cdnjs.cloudflare.com/ajax/libs/axios/1.1.3/axios.min.js"></script>

    
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.6.0/jquery.min.js"></script>
    <script src="vue.js"></script>
    <script src="swal2.js"></script>

    <script src="https://cdn.jsdelivr.net/npm/vuetify@2.x/dist/vuetify.js"></script>
    <!-- <link href="https://cdn.jsdelivr.net/npm/vuetify@2.x/dist/vuetify.min.css" rel="stylesheet"/> -->
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.0.2/dist/css/bootstrap.min.css" rel="stylesheet" integrity="sha384-EVSTQN3/azprG1Anm3QDgpJLIm9Nao0Yz1ztcQTwFspd3yD65VohhpuuCOmLASjC" crossorigin="anonymous">  
    <script src="https://kit.fontawesome.com/9982368510.js" crossorigin="anonymous"></script>   
</head>
    <body class="bg-transparent">
        <v-app data-app>
            <div id="app">
                <div v-if="show.characters == true" class="container-fluid row g-0 min-vh-100 text-center bg-transparent">
                    <div class="col-5 border-end border-secondary border-5 bg-dark">
                        <div class="row w-100 d-flex align-items-start mx-auto" style="height:30%!important;">
                            <img src="https://media.discordapp.net/attachments/1042261598972157952/1044830067861246022/unknown.png?width=671&height=671" alt="Logo Img" class="w-25 g-0 mx-auto">
                            <div class="row">
                                <h1 class="text-white text-center fw-bold">Welcome To Limitless RP!</h1>
                                <h2 class="text-white text-center fw-bold mb-2" href="discord.gg/lrp">discord.gg/lrp</h2>
                            </div>
                        </div>
                        <div class="row w-100 my-4 mx-auto text-light text-start px-2 d-flex align-items-center" style="height: 50%!important; min-height: 50%!important;">
                            <div class="row mx-auto" style="width: 80%!important;"> 
                                <h1 class="w-auto mx-auto my-auto" id="char-cur">Character Info ({{ curCharIndex }}/{{ characterAmount }}):</h1> 
                                <div v-if="show.charInfo === true">  
                                    <div class="row g-0 pt-2">
                                        <div class="col-4">
                                            <h1>Name:</h1>
                                        </div>
                                        <div class="col-8 text-start">
                                            <h1 id="char-name">{{ curCharData.name }}</h1>
                                        </div>
                                    </div>  
                                    <div class="row g-0">
                                        <div class="col-4">
                                            <h1>DOB:</h1>
                                        </div>
                                        <div class="col-8 text-start">
                                            <h1 id="char-dob">{{ curCharData.dob }}</h1>
                                        </div>
                                    </div>
                                    <div class="row g-0">
                                        <div class="col-4">
                                            <h1>Gender: </h1>
                                        </div>
                                        <div class="col-8 text-start">
                                            <h1 id="char-gender">{{ curCharData.sex }}</h1>
                                        </div>
                                    </div>
                                    <div class="row g-0">
                                        <div class="col-4">
                                            <h1>Job:</h1>
                                        </div>
                                        <div class="col-8 text-start">
                                            <h1 id="char-job">{{curCharData.job}}</h1>
                                        </div>
                                    </div>
                                    <div class="row g-0">
                                        <div class="col-4">
                                            <h1>Cash:</h1>
                                        </div>
                                        <div class="col-8 text-start">
                                            <h1 id="char-cash">{{curCharData.cash}}</h1>
                                        </div>
                                    </div>
                                    <div class="row g-0">
                                        <div class="col-4">
                                            <h1>Bank:</h1>
                                        </div>
                                        <div class="col-8 text-start">
                                            <h1 id="char-bank">{{curCharData.bank}}</h1>
                                        </div>
                                    </div>
                                </div>
                                <div v-if="show.regBtn === true">
                                    <p>This character is undetected. Please register a new one! If you belive there has been an error contact development inside the discord!</p>
                                </div>
                                <div class="text-center p-5" v-if="show.sync === true">
                                    <i class="fas fa-circle-notch fa-spin fa-10x"></i>
                                </div>
                            </div>
                        </div>
                        <div v-if="show.sync !== true" class="row text-center my-2 mx-auto p-0 d-flex align-items-start" style="height:10%!important; width: 80%!important;">
                                <div class="col-2 ps-1 pe-1">
                                    <button class="btn btn-secondary w-100" @click="prevCharIndex();setCharData();"><i class="fa fa-solid fa-arrow-left"></i></button>
                                </div>
                                <div class="col-7 p-0" v-if="show.regBtn === false">
                                    <button class="btn btn-success w-100" id="play-btn" @click="play_character"><i class="fa fa-solid fa-play"></i> Play</button>
                                </div>
                                <div class="col-8" v-if="show.regBtn === true">
                                    <button class="btn btn-success w-100" id="reg-btn" data-bs-toggle="modal" href="#regModalTrgt" role="button"><i class="fa fa-solid fa-clipboard"></i> Register</button>
                                </div>    
                                <div class="col-1 p-0 ps-1" v-if="show.regBtn === false">    
                                    <button class="btn btn-danger w-100" id="play-btn" data-bs-toggle="modal" href="#delModalTrgt"><i class="fa fa-trash" aria-hidden="true"></i></button>
                                </div>                          
                                <div class="col-2 ps-1 pe-1">
                                    <button class="btn btn-secondary w-100" id="next-char" @click="nextCharIndex();setCharData();"><i class="fa fa-solid fa-arrow-right"></i></button>
                                </div>
                        </div>
                    </div>
                    <div class="col-7 bg-transparent">

                    </div>
                </div>
                <div class="modal fade" id="regModalTrgt" aria-hidden="true" aria-labelledby="regModalTrgtLbl" data-bs-backdrop="static" tabindex="-1">
                    <div class="modal-dialog modal-dialog-centered" style="max-width: 65%;">
                        <div class="modal-content bg-dark text-light">
                            <div class="modal-header">
                                <h5 class="modal-title" id="regModTit">Character Registration</h5>
                            </div>
                            <div class="modal-body">
                                <div class="row" v-if="show.RegWait === false">
                                    <div class="col-md-6 mb-3">
                                        <label for="fname-input" class="form-label">First Name</label>
                                        <input class="form-control" id="fname-input" placeholder="John" required>
                                    </div>
                                    <div class="col-md-6 mb-3">
                                        <label for="lname-input" class="form-label">Last Name</label>
                                        <input class="form-control" id="lname-input" placeholder="Doe" required>
                                    </div>
                                </div>
                                <div class="row" v-if="show.RegWait === false">
                                    <div class="col-md-4 mb-3">
                                        <label for="sex-input" class="form-label">Sex</label>
                                        <select class="form-control " id="sex-input" required>
                                            <option value="male" selected>Male</option>
                                            <option value="female">Female</option>
                                        </select>
                                    </div>
                                    <div class="col-md-4 mb-3 ">
                                        <label for="dob-input" class="form-label">Date of Birth</label>
                                        <input class="form-control" type="date" id="dob-input" placeholder="doe" required>
                                    </div>
                                    <div class="col-md-4 mb-3">
                                        <label for="dept-input" class="form-label">Nationality</label>
                                        <select class="form-control dropdown" id="nationality" required>
                                        </select>
                                    </div>
                                </div>
                                <div class="text-center p-5 mx-auto" v-if="show.RegWait === true">
                                    <i class="fas fa-circle-notch fa-spin fa-10x"></i>
                                </div>
                            </div>
                            <div class="modal-footer" v-if="show.RegWait === false">
                                <button class="btn btn-secondary" data-bs-dismiss="modal" aria-label="Close">Return</button>
                                <button class="btn btn-success" @click="create_character">Register</button>
                            </div>
                        </div>
                    </div>
                </div>
                <div class="modal fade" id="delModalTrgt" aria-hidden="true" aria-labelledby="delModelTglLbl" data-bs-backdrop="static" tabindex="-1">
                    <div class="modal-dialog modal-dialog-centered" style="max-width: 65%;">
                        <div class="modal-content bg-dark text-light">
                            <div class="modal-header">
                                <h5 class="modal-title text-light" id="delmodtit">Character Delete Confirmation</h5>
                            </div>

                            <div class="modal-body">
                                <div class="row mx-auto">
                                    <div v-if="show.delWait === false">
                                        <div class="col-10 mb-3 mx-auto">
                                            <h2 class="text-center fs-4 fw-normal">Please enter the name of the character you want to delete. The name should be <strong>"{{ curCharData.name }}"</strong>.
                                                If this is not the chachter you want to delete then do not enter anything in the box, and press return. <strong>This action is irreversible!</strong>
                                            </h2>
                                        </div>
                                        <div class="row mx-auto">
                                            <div class="col-md-6 mb-3 mx-auto">
                                                <form>
                                                    <input class="form-control" id="del-input" placeholder="Character Name" required>
                                                    <div class="valid-feedback">
                                                        Valid Name, User can be deleted now!
                                                    </div>
                                                    <div class="invalid-feedback">
                                                        Invalid Name, User can not be deleted!
                                                    </div>
                                                </form>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                                <div class="text-center p-5 mx-auto" v-if="show.delWait === true">
                                    <i class="fas fa-circle-notch fa-spin fa-10x"></i>
                                </div>
                            </div>

                            <div class="modal-footer">
                                <button class="btn btn-secondary" data-bs-dismiss="modal" aria-label="Close">Return</button>
                                <button class="btn btn-danger" @click="delCurChar">Delete</button>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </v-app>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/materialize/1.0.0/js/materialize.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.0.2/dist/js/bootstrap.bundle.min.js" integrity="sha384-MrcW6ZMFYlzcLA8Nl+NtUVF0sA7MsXsP1UyJoMp4YLEuNSfAP+JcXn/tWtIaxVXM" crossorigin="anonymous"></script>

    </body>
    <script type="text/javascript" src="profanity.js"></script>
    <script>
        let re = '(' + profList.join('|') + ')\\b'
        const regTest = new RegExp(re, 'i');

        const viewmodel = new Vue({
            el: "#app",
            vuetify: new Vuetify(),
            data: {
                characters: [],
                chardata: {},
                curCharIndex: 1,
                curCharData: {
                    name: undefined,
                    dob: undefined,
                    sex: undefined,
                    job: undefined,
                    cash: undefined,
                    bank: undefined,
                    extraData: undefined,
                    charid: undefined,
                },
                show: {
                    loading: false,
                    characters: false,
                    register: false,
                    delete: false,
                    charInfo: false,
                    regBtn: false,
                    sync: true,
                    delWait: false,
                    RegWait: false,
                },
                registerData: {
                    date: (new Date(Date.now() - (new Date()).getTimezoneOffset() * 60000)).toISOString().substr(0, 10),
                    firstname: undefined,
                    lastname: undefined,
                    nationality: undefined,
                    gender: undefined
                },
                allowDelete: false,
                dataPickerMenu: false,
                characterAmount: 0,
                loadingText: "",
                selectedCharacter: -1,
                dollar: Intl.NumberFormat('en-US'),
                translations: {},
                customNationality:false,
                nationalities: []
            },
            methods: {
                async fetchData() {
                    const response = await fetch('https://countriesnow.space/api/v0.1/countries/');
                    if(response){
                        const data = await response.json();
                        const result = data.data;

                        const selectDrop = document.getElementById('nationality');
                        
                        result.forEach(obj => {
                            this.nationalities.push(obj.country);
                        });
                    }
                },

                nextCharIndex: function() {
                    if (viewmodel.curCharIndex == 5)
                    {    
                        viewmodel.curCharIndex = 1
                    }
                    else
                    {
                        viewmodel.curCharIndex = viewmodel.curCharIndex + 1
                    }
                },

                prevCharIndex: function() {
                    if (viewmodel.curCharIndex == 1)
                    {    
                        viewmodel.curCharIndex = 5
                    }
                    else
                    {
                        viewmodel.curCharIndex = viewmodel.curCharIndex - 1
                    }
                },

                setCharData: function() {
                    if (viewmodel.characters[viewmodel.curCharIndex] !== undefined){
                        viewmodel.show.regBtn = false
                        viewmodel.show.charInfo = false
                        viewmodel.show.sync = true

                        var ch = viewmodel.curCharData
                        var da = viewmodel.characters[viewmodel.curCharIndex]
                        ch.name = da.charinfo.firstname + " " + da.charinfo.lastname
                        ch.dob = da.charinfo.birthdate
                        ch.job = da.job.label
                        ch.cash = da.money.cash
                        ch.bank = da.money.bank
                        ch.extraData = da
                        ch.charid = da.cid
                        if (da.charinfo.gender == 0){
                            ch.sex = "Male"        
                        } else {
                            ch.sex = "Female"
                        }

                        axios.post('https://qb-multicharacter/cDataPed', {
                            cData: viewmodel.characters[viewmodel.curCharIndex]
                        }).then(function(resp){
                            if(resp){
                                viewmodel.show.charInfo = true
                                viewmodel.show.sync = false
                            }else {
                                viewmodel.show.charInfo = true
                                viewmodel.show.sync = false
                            }
                        });
                    } else {
                        viewmodel.show.regBtn = false
                        viewmodel.show.charInfo = false
                        viewmodel.show.sync = true

                        axios.post('https://qb-multicharacter/cDataPed', {}).then(function(resp){
                            if(resp){
                                viewmodel.show.regBtn = true
                                viewmodel.show.sync = false
                            }else {
                                viewmodel.show.regBtn = true
                                viewmodel.show.sync = false
                            }
                        })
                    }
                },

                save: function(date) {
                    this.$refs.menu.save(date)
                },

                delCurChar: function() {
                    if(document.getElementById("del-input").value !== viewmodel.curCharData.name)
                    {
                        
                        document.getElementById("del-input").classList.add("is-invalid");
                        document.getElementById("del-input").classList.remove("is-valid");
                        
                    } else if (document.getElementById("del-input").value === viewmodel.curCharData.name){
                        document.getElementById("del-input").classList.remove("is-invalid");
                        document.getElementById("del-input").classList.add("is-valid");
                        viewmodel.show.delWait = true
                        viewmodel.show.charInfo = false
                        viewmodel.show.sync = true
                        

                        axios.post('https://qb-multicharacter/removeCharacter', {
                            citizenid: viewmodel.curCharData.extraData.citizenid
                        }).then(function(resp) {
                            if (resp)
                            {
                                viewmodel.show.delWait = false
                                var delModHt = document.getElementById("delModalTrgt")
                                var delModBt = bootstrap.Modal.getInstance(delModHt)
                                delModBt.hide();
                            }
                            else
                            {
                                var delModHt = document.getElementById("delModalTrgt")
                                var delModBt = bootstrap.Modal.getInstance(delModHt)
                                delModBt.hide();
                                viewmodel.show.delWait = false
                            }
                        });
                    }
                },

                delete_character: function() {
                    if (viewmodel.show.delete == true) {
                        viewmodel.show.delete = false
                        axios.post('https://qb-multicharacter/removeCharacter', {
                            citizenid: viewmodel.characters[viewmodel.selectedCharacter].citizenid
                        });
                    }
                    else {
                        if (viewmodel.show.characters == true && viewmodel.show.register == false) {
                            viewmodel.show.characters = false
                            viewmodel.show.delete = true
                        }
                    }
                },

                play_character: function() {
                    // if (viewmodel.selectedCharacter && viewmodel.selectedCharacter !== -1) {
                    //     var data = viewmodel.characters[viewmodel.selectedCharacter]

                    //     if (data !== undefined) {
                    //         axios.post('https://qb-multicharacter/selectCharacter', {
                    //             cData: data
                    //         });
                    //         setTimeout(function() {
                    //             viewmodel.show.characters = false
                    //         }, 500)
                    //     }
                    //     else {
                    //         viewmodel.registerData.firstname = undefined
                    //         viewmodel.registerData.lastname = undefined
                    //         viewmodel.registerData.nationality = undefined
                    //         viewmodel.registerData.gender = undefined
                    //         viewmodel.registerData.date = (new Date(Date.now() - (new Date()).getTimezoneOffset() * 60000)).toISOString().substr(0, 10)

                    //         viewmodel.show.characters = false
                    //         viewmodel.show.register = true
                    //     }
                    // }

                    if (viewmodel.characters[viewmodel.curCharIndex] !== undefined)
                    {  
                            axios.post('https://qb-multicharacter/selectCharacter', {
                                cData: viewmodel.characters[viewmodel.curCharIndex]
                            });
                            setTimeout(function() {
                                viewmodel.show.characters = false
                            }, 500)
                    }

                },

                create_character: function() {
                    const registerData = viewmodel.registerData

                    registerData.firstname = document.getElementById("fname-input").value
                    registerData.lastname = document.getElementById("lname-input").value
                    registerData.gender = document.getElementById("sex-input").value
                    registerData.date = new Date(document.getElementById("dob-input").value)
                    registerData.nationality = document.getElementById("nationality").value

                    viewmodel.show.sync = true;
                    viewmodel.show.RegWait = true;
                   
                    var profanityTest = (!regTest.test(registerData.firstname) && !regTest.test(registerData.nationality) && !regTest.test(registerData.lastname))

                    if (!profanityTest)
                    {
                        Swal.fire({
                            icon: 'error',
                            title: viewmodel.translate('ran_into_issue'),
                            text: viewmodel.translate('profanity'),
                            timer: 5000,
                            timerProgressBar: true,
                            showConfirmButton: false
                        })

                        viewmodel.show.sync = false;
                        viewmodel.show.RegWait = false;
                        viewmodel.show.regBtn = true;

                    }else if (registerData.firstname === undefined
                    || registerData.firstname === "" )
                    {
                        Swal.fire({
                            icon: 'error',
                            title: viewmodel.translate('ran_into_issue'),
                            text: "Invalid First Name",
                            timer: 5000,
                            timerProgressBar: true,
                            showConfirmButton: false
                        })

                        viewmodel.show.sync = false;
                        viewmodel.show.RegWait = false;
                        viewmodel.show.regBtn = true;
                    }else if (registerData.lastname === undefined
                    || registerData.lastname === "" )
                    {
                        Swal.fire({
                            icon: 'error',
                            title: viewmodel.translate('ran_into_issue'),
                            text: "Invalid Last Name",
                            timer: 5000,
                            timerProgressBar: true,
                            showConfirmButton: false
                        })

                        viewmodel.show.sync = false;
                        viewmodel.show.RegWait = false;
                        viewmodel.show.regBtn = true;
                    }else if (registerData.gender === undefined
                    || registerData.gender === "" )
                    {
                        Swal.fire({
                            icon: 'error',
                            title: viewmodel.translate('ran_into_issue'),
                            text: "Invalid Gender",
                            timer: 5000,
                            timerProgressBar: true,
                            showConfirmButton: false
                        })

                        viewmodel.show.sync = false;
                        viewmodel.show.RegWait = false;
                        viewmodel.show.regBtn = true;
                    }else if (registerData.nationality === undefined
                    || registerData.nationality === "")
                    {
                        Swal.fire({
                            icon: 'error',
                            title: viewmodel.translate('ran_into_issue'),
                            text: "Invalid Nationality",
                            timer: 5000,
                            timerProgressBar: true,
                            showConfirmButton: false
                        })

                        viewmodel.show.sync = false;
                        viewmodel.show.RegWait = false;
                        viewmodel.show.regBtn = true;
                    }else if (registerData.date === undefined
                    || registerData.date === "" )
                    {
                        Swal.fire({
                            icon: 'error',
                            title: viewmodel.translate('ran_into_issue'),
                            text: "Invalid DOB",
                            timer: 5000,
                            timerProgressBar: true,
                            showConfirmButton: false
                        })

                        viewmodel.show.sync = false;
                        viewmodel.show.RegWait = false;
                        viewmodel.show.regBtn = true;
                    }else if (registerData.date.getFullYear() > 2004
                    || registerData.date.getFullYear() < 1905)
                    {
                        Swal.fire({
                            icon: 'error',
                            title: viewmodel.translate('ran_into_issue'),
                            text: "Invalid DOB, please select a year before 2004, and after 1905.",
                            timer: 5000,
                            timerProgressBar: true,
                            showConfirmButton: false
                        })

                        viewmodel.show.sync = false;
                        viewmodel.show.RegWait = false;
                        viewmodel.show.regBtn = true;
                    } else if (registerData.firstname !== undefined
                    && registerData.firstname !== "" 
                    && registerData.lastname !== undefined 
                    && registerData.lastname !== "" 
                    && registerData.gender !== undefined
                     && registerData.nationality !== undefined
                      && registerData.nationality !== "" 
                      && registerData.date !== undefined
                      && registerData.date !== "") {
                        viewmodel.show.register = false

                        var dateStr = registerData.date.toISOString();

                        axios.post('https://qb-multicharacter/createNewCharacter', {
                            firstname: registerData.firstname,
                            lastname: registerData.lastname,
                            nationality: registerData.nationality,
                            birthdate: dateStr.substr(0, 10),
                            gender: registerData.gender,
                            cid: viewmodel.curCharIndex,
                        }).then(function(r) {
                            if(r){
                                var regModalHt = document.getElementById("regModalTrgt")
                                var regModBt = bootstrap.Modal.getInstance(regModalTrgt)
                                regModBt.hide();
                                
                            }else{
                                var regModalHt = document.getElementById("regModalTrgt")
                                var regModBt = bootstrap.Modal.getInstance(regModalTrgt)
                                regModBt.hide();
                            }
                        });
                    }
                    else {
                        if (!profanityTest) {
                            viewmodel.show.sync = false;
                            viewmodel.show.RegWait = false;
                            Swal.fire({
                                icon: 'error',
                                title: viewmodel.translate('ran_into_issue'),
                                text: viewmodel.translate('profanity'),
                                timer: 5000,
                                timerProgressBar: true,
                                showConfirmButton: false
                            })
                        }
                        else {
                            viewmodel.show.sync = false;
                            viewmodel.show.RegWait = false;
                            Swal.fire({
                                icon: 'error',
                                title: viewmodel.translate('ran_into_issue'),
                                text: "Unkown Error Contact Development.",
                                timer: 5000,
                                timerProgressBar: true,
                                showConfirmButton: false
                            })
                        }
                    }
                    
                    // if (registerData.firstname !== undefined
                    // && registerData.firstname !== "" 
                    // && registerData.lastname !== undefined 
                    // && registerData.lastname !== "" 
                    // && registerData.gender !== undefined
                    //  && registerData.nationality !== undefined
                    //   && registerData.nationality !== "" 
                    //   && registerData.date !== undefined
                    //   && registerData.date !== "") {
                    //     viewmodel.show.register = false

                    //     axios.post('https://qb-multicharacter/createNewCharacter', {
                    //         firstname: registerData.firstname,
                    //         lastname: registerData.lastname,
                    //         nationality: registerData.nationality,
                    //         birthdate: registerData.date,
                    //         gender: registerData.gender,
                    //         cid: viewmodel.selectedCharacter,
                    //     }).then(function(r) {
                    //         if(r){
                    //             var regModalHt = document.getElementById("regModalTrgt")
                    //             var regModBt = bootstrap.Modal.getInstance(regModalTrgt)
                    //             regModBt.hide();
                                
                    //         }else{
                    //             var regModalHt = document.getElementById("regModalTrgt")
                    //             var regModBt = bootstrap.Modal.getInstance(regModalTrgt)
                    //             regModBt.hide();
                    //         }
                    //     });
                    // }
                    // else {
                    //     if (!profanityTest) {
                    //         viewmodel.show.sync = false;
                    //         viewmodel.show.RegWait = false;
                    //         Swal.fire({
                    //             icon: 'error',
                    //             title: viewmodel.translate('ran_into_issue'),
                    //             text: viewmodel.translate('profanity'),
                    //             timer: 5000,
                    //             timerProgressBar: true,
                    //             showConfirmButton: false
                    //         })
                    //     }
                    //     else {
                    //         viewmodel.show.sync = false;
                    //         viewmodel.show.RegWait = false;
                    //         Swal.fire({
                    //             icon: 'error',
                    //             title: viewmodel.translate('ran_into_issue'),
                    //             text: viewmodel.translate('forgotten_field'),
                    //             timer: 5000,
                    //             timerProgressBar: true,
                    //             showConfirmButton: false
                    //         })
                    //     }
                    // }
                },

                translate(phrase) {
                    return viewmodel.translations[phrase] || phrase;
                }
            },
            mounted () {
                this.fetchData()
                var loadingProgress = 0;
                var loadingDots = 0;
                window.addEventListener('message', function (event) {
                    var data = event.data;
                    switch(data.action) {
                        case "ui":
                            viewmodel.customNationality = event.data.customNationality
                            viewmodel.translations = event.data.translations
                            viewmodel.characterAmount = data.nChar;
                            viewmodel.curCharIndex = 1
                            viewmodel.show.register = false
                            viewmodel.show.delete = false
                            viewmodel.show.characters = false
                            viewmodel.show.charInfo = false
                            viewmodel.allowDelete = event.data.enableDeleteButton
                            EnableDeleteButton = data.enableDeleteButton;
                            if (data.toggle == true) {
                                viewmodel.show.sync = true
                                viewmodel.show.characters = true

                                viewmodel.loadingText = viewmodel.translate('retrieving_playerdata');
                                var DotsInterval = setInterval(function () {
                                    loadingDots++;
                                    loadingProgress++;
                                    if (loadingProgress == 3) {
                                        viewmodel.loadingText = viewmodel.translate('validating_playerdata')
                                    }
                                    if (loadingProgress == 4) {
                                        viewmodel.loadingText = viewmodel.translate('retrieving_characters')
                                    }
                                    if (loadingProgress == 6) {
                                        viewmodel.loadingText = viewmodel.translate('validating_characters')
                                    }
                                    if (loadingDots == 4) {
                                        loadingDots = 0;
                                    }
                                }, 500);

                                setTimeout(function () {
                                    axios.post('https://qb-multicharacter/setupCharacters');
                                    setTimeout(function () {
                                        clearInterval(DotsInterval);
                                        loadingProgress = 0;
                                        viewmodel.loadingText = viewmodel.translate('retrieving_playerdata');
                                        viewmodel.show.loading = false
                                        viewmodel.show.characters = true
                                        axios.post('https://qb-multicharacter/removeBlur');
                                        viewmodel.setCharData();
                                        var nationhtml = "";
                                        viewmodel.nationalities.forEach(obj => {
                                            if(obj == "United States"){
                                                nationhtml += "<option selected>"+obj+"</option>"
                                            } else {
                                                nationhtml += "<option>"+obj+"</option>"
                                            }
                                            
                                        })
                                        document.getElementById("nationality").innerHTML = nationhtml
                                    }, 2000);
                                }, 2000);

                            }
                            break;
                        case "setupCharacters":
                            var newChars = []
                            for (var i = 0; i < event.data.characters.length; i++) {
                                newChars[event.data.characters[i].cid] = event.data.characters[i]
                            }
                            viewmodel.characters = newChars
                            break;
                        case "setupCharInfo":
                            viewmodel.chardata = event.data.chardata
                            break;
                    }
                });
            }
            
        });

        $(document).ready(function() {
            $(window).keydown(function(event){
                if(event.keyCode == 13) {
                event.preventDefault();
                return false;
                }
            });
        });
    </script>
</html>